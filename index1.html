<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>
    <link rel="icon" href="lionn.jpg" type="image/png">
    <link rel="icon" type="image/x-icon" href="Images/trans1.png">
    <link rel="stylesheet" href="index1.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Outfit:wght@100;400;700&family=Titillium+Web:wght@200;300;400;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
</head>

<body>
    <div class="header">
        <div class="container">
            <div class="navbar">
                <div class="logo">
                    <a href="index.html"><img src="lionn.jpg" width="125px" alt></a>
                </div>
                <div class="menu-container">
                    <div class="username" id="message">
                        <p><span id="userName"></span></p>
                    </div>
                    <nav>
                        <ul id="MenuItems">
                            <div class="nav-links">
                                <ul>
                                    <a href="index.html" class="hero-btn">Home</a>
                                    <a href="about.html" class="hero-btn">About</a>
                                    <a href="inventory.html" class="hero-btn">Inventory</a>
                                    <a href="contact.html" class="hero-btn">Contact</a>
                                    <a href="help.html" class="hero-btn">Help</a>
                                </ul>
                            </div>
                            <li><button class="btn" id="myBtn"><i class="fa fa-user"></i> Log in</button></li>

                            <li>
                                <a id="myBtn2" href="cart.html">
                                    <img src="images/image 33.jpeg" alt="Shopping Cart" width="30px" height="30px">
                                    View cart
                                </a>
                            </li>

                            <li><button class="btn" id="signOut">Log out <i class="fa fa-sign-out"></i></button></li>
                        </ul>
                        <img src="Images/menu.png" alt="" class="menu-icon" onclick="menutoggle()">
                    </nav>
                </div>
            </div>
            <!-- Login Modal -->
            <div id="myModal" class="modal">
                <div class="modal-content">
                    <span class="close" onclick="closeModal()">&times;</span>
                    <div class="form-container">
                        <div class="form-btn">
                            <span onclick="login()">Login</span>
                            <span onclick="register()">Register</span>
                            <span onclick="signin()">Social</span>
                            <hr id="Indicator">
                        </div>
                        <!-- Login Form -->
                        <form action="" id="loginform" class="signin">
                            <input type="email" placeholder="Enter Email">
                            <input type="password" placeholder="Enter Password">
                            <button type="submit" class="btn">Login</button>
                            <a href="">Forgot Password</a>
                            <button type="button" class="logout" id="logoutBtn" onclick="userSignOut()">Logout</button>
                        </form>
                        <!-- Registration Form -->
                        <form action="" id="registrationform" class="signup">
                            <input id="name" type="text" placeholder="Name">
                            <input id="email" type="email" placeholder="Email">
                            <input id="password" type="password" placeholder="Password">
                            <button id="btn" type="submit" class="btn">Register</button>
                        </form>
                        <!-- Social Sign-in Buttons -->
                        <div class="socials" id="socials">
                            <button class="btn" id="signInGoogle" onclick="userSignIn()">Sign in with Google <i
                                    class="fa fa-google"></i></button>
                            <button class="btn" id="signInFacebook" onclick="userSignInFb()">Sign in with Facebook <i
                                    class="fa fa-facebook"></i></button>
                            <button class="btn" id="signInTwitter" onclick="userSignInTw()">Sign in with Twitter <i
                                    class="fa fa-twitter"></i></button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Cart Modal -->
            <div id="myModal2" class="modal2">
                <!-- Cart content goes here -->
            </div>
        </div>
    </div>
    <div class="text-box">
        <h1>Welcome to Archer Movies/Series Dealership</h1>
        <p>Discover the best Movies/Series at the most affordable prices.</p>

        <a href="inventory.html" class="hero-btn">View</a>

    </div>
    </header>

    <div class="container">
        <section class="about">
            <h2>About Us</h2>
            <p>Your trusted source for quality Movies.</p>
        </section>

        <section class="inventory">
            <h2>Our Inventory</h2>
            <p>Explore our wide selection of Series.</p>
            <a href="#" class="hero-btn">View Inventory</a>
        </section>
    </div>
    <div class="footer-col-1">
        <h3>Download our App</h3>
        <p>Lorem ipsum dolor sit amet consectetur adipisicing elit. Quibusdam vel magnam in molestias
            consectetur, error accusamus facere quia aspernatur ea unde commodi libero voluptates atque
            odit, maxime praesentium ut pariatur!</p>
        <div class="app-logo">
            <img src="app-store.png" alt="">
            <img src="play-store.png" alt="">
        </div>
    </div>

    <footer>
        <div class="container">
            <div class="footer-left">
                <div class="f-newsletter">
                    <h3 class="f-menu-title">Newsletter</h3>
                    <form class="f-form">
                        <input type="email" class="f-input" placeholder="Enter your email">
                        <button class="f-button">Subscribe</button>
                    </form>
                </div>

            </div>

        </div>
        <div class="footer-right">
            <div class="f-icons">
                <a href="https://www.facebook.com"><i class="fab fa-facebook fa-3x"></i></a>
                <a href="https://www.twitter.com"><i class="fab fa-twitter fa-3x"></i></a>
                <a href="https://www.instagram.com"><i class="fab fa-instagram fa-3x"></i></a>
            </div>
            <div class="i">
                <!-- Slides go here -->
            </div>
            <p class="copyright">&copy; 2023 Archer Car Dealership</p>
        </div>

        <script src="bundle.js"></script>
        <script>
            // Add your existing scripts here
            // ...
        </script>
        <script>
            var MenuItems = document.getElementById("MenuItems");
            MenuItems.style.maxHeight = "0px";
            function menutoggle() {
                if (MenuItems.style.maxHeight == "0px") {
                    MenuItems.style.maxHeight = "200px";
                }
                else {
                    MenuItems.style.maxHeight = "0px";
                }
            }
        </script>
        <script>
            // Get the modal
            var modal = document.getElementById("myModal");
            var modal2 = document.getElementById("myModal2");

            // Get the button that opens the modal
            var btn = document.getElementById("myBtn");
            var btn2 = document.getElementById("myBtn2");

            // Get the <span> element that closes the modal
            var span = document.getElementsByClassName("close")[0];
            var span2 = document.getElementsByClassName("close2")[0];

            // When the user clicks on the button, open the modal
            btn.onclick = function () {
                modal.style.display = "block";
            }
            btn2.onclick = function () {
                modal2.style.display = "block";
            }

            // When the user clicks on <span> (x), close the modal
            span.onclick = function () {
                modal.style.display = "none";
            }
            span2.onclick = function () {
                modal2.style.display = "none";
            }

            // When the user clicks anywhere outside of the modal, close it
            window.onclick = function (event) {
                if (event.target == modal) {
                    modal.style.display = "none";
                }
                else if (event.target == modal2) {
                    modal2.style.display = "none";
                };
            }
        </script>

        <script>
            var MenuItems = document.getElementById("MenuItems");
            MenuItems.style.maxHeight = "0px";
            function menutoggle() {
                if (MenuItems.style.maxHeight == "0px") {
                    MenuItems.style.maxHeight = "200px";
                }
                else {
                    MenuItems.style.maxHeight = "0px";
                }
            }
        </script>
        <!-- js for toggle form -->
        <script>
            var loginform = document.getElementById("loginform");
            var registrationform = document.getElementById("registrationform");
            var socials = document.getElementById("socials");
            var Indicator = document.getElementById("Indicator");

            function register() {
                registrationform.style.transform = "translateX(0px)";
                loginform.style.transform = "translateX(0px)";
                socials.style.transform = "translateX(0px)";
                Indicator.style.transform = "translateX(100px)";
            }
            function login() {
                registrationform.style.transform = "translateX(400px)";
                loginform.style.transform = "translateX(400px)";
                socials.style.transform = "translateX(400px)";
                Indicator.style.transform = "translateX(0px)";
            }
            function signin() {
                registrationform.style.transform = "translateX(-400px)";
                loginform.style.transform = "translateX(-400px)";
                socials.style.transform = "translateX(-400px)";
                Indicator.style.transform = "translateX(210px)";
            }
        </script>
        <script type="module">

            import { initializeApp } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js";


            import {
                createUserWithEmailAndPassword, signInWithEmailAndPassword,
                getAuth, GoogleAuthProvider, TwitterAuthProvider, FacebookAuthProvider,
                signInWithPopup, signOut, onAuthStateChanged
            }
                from "https://www.gstatic.com/firebasejs/10.0.0/firebase-auth.js";

            const firebaseConfig = {
                apiKey: "AIzaSyBk_55iuyj_3PYCIw8UNdf521oTxlk6DC0",
                authDomain: "kelly-s-1fe05.firebaseapp.com",
                databaseURL: "https://kelly-s-1fe05-default-rtdb.firebaseio.com",
                projectId: "kelly-s-1fe05",
                storageBucket: "kelly-s-1fe05.appspot.com",
                messagingSenderId: "992365918258",
                appId: "1:992365918258:web:7dac291538e4389273e42b"
            };

            const app = initializeApp(firebaseConfig);
            const auth = getAuth();
            const googleProvider = new GoogleAuthProvider();
            const twitterProvider = new TwitterAuthProvider();
            const facebookProvider = new FacebookAuthProvider();

            const mModal2 = document.getElementById("myModal2");
            const mModal = document.getElementById("myModal");
            const mButton = document.getElementById("myBtn");
            const signInButton = document.getElementById("signInGoogle");
            const signInTw = document.getElementById("signInTwitter");
            const signInFb = document.getElementById("signInFacebook")
            const signOutButton = document.getElementById("signOut");
            const message = document.getElementById("message");
            const userName = document.getElementById("userName");

            signOutButton.style.display = "none";
            message.style.display = "none";

            const signupForm = document.querySelector('.signup')
            signupForm.addEventListener('submit', (e) => {
                e.preventDefault()

                const name = document.getElementById('name').value
                const email = document.getElementById('email').value
                const password = document.getElementById('password').value

                createUserWithEmailAndPassword(auth, email, password)
                    .then((cred) => {
                        console.log('user created:', cred.user)
                        signupForm.reset()

                        updateProfile(cred.user, {
                            displayName: name
                        }).then(() => {
                            console.log('Display name set:', name);
                            const userName = document.querySelector('.username');
                            userName.innerHTML = name;
                        }).catch((error) => {
                            console.error('Error setting display name:', error);
                        });
                    })
                    .catch((err) => {
                        console.log(err)
                    })
            })

            const userSignIn = async () => {
                signInWithPopup(auth, googleProvider)
                    .then((result) => {
                        const user = result.user
                        console.log(user);
                    }).catch((error) => {
                        const errorCode = error.code;
                        const errorMessage = error.message
                    })
            }
            const userSignInTw = async () => {
                signInWithPopup(auth, twitterProvider)
                    .then((result) => {
                        // This gives you a the Twitter OAuth 1.0 Access Token and Secret.
                        // You can use these server side with your app's credentials to access the Twitter API.
                        const credential = TwitterAuthProvider.credentialFromResult(result);
                        const token = credential.accessToken;
                        const secret = credential.secret;

                        // The signed-in user info.
                        const user = result.user;
                        // IdP data available using getAdditionalUserInfo(result)
                        // ...
                    }).catch((error) => {
                        // Handle Errors here.
                        const errorCode = error.code;
                        const errorMessage = error.message;
                        // The email of the user's account used.
                        const email = error.customData.email;
                        // The AuthCredential type that was used.
                        const credential = TwitterAuthProvider.credentialFromError(error);
                        // ...
                    });
            }
            const userSignInFb = async () => {
                signInWithPopup(auth, facebookProvider)
                    .then((result) => {

                        const credential = FacebookAuthProvider.credentialFromResult(result);
                        const token = credential.accessToken;
                        const secret = credential.secret;

                        // The signed-in user info.
                        const user = result.user;
                        // IdP data available using getAdditionalUserInfo(result)
                        // ...
                    }).catch((error) => {
                        // Handle Errors here.
                        const errorCode = error.code;
                        const errorMessage = error.message;
                        // The email of the user's account used.
                        const email = error.customData.email;
                        // The AuthCredential type that was used.
                        const credential = TwitterAuthProvider.credentialFromError(error);
                        // ...
                    });
            }

            const userSignOut = async () => {
                signOut(auth).then(() => {
                    alert("You have signed out successfully!");
                }).catch((error) => { })
            }

            // Get the cart button element
            const cartButton = document.getElementById("myBtn2");

            // Add an event listener to the cart button
            cartButton.addEventListener('click', function () {
                // Check if the user is signed in
                const user = auth.currentUser;

                if (user) {
                    // If the user is logged in, fetch the user's cart data from the server and display the cart modal
                    fetchUserCartData(user.uid)
                        .then((cartData) => {
                            // Process and display the cart data
                            console.log("User's Cart Data:", cartData);
                            modal2.style.display = "block";
                        })
                        .catch((error) => {
                            console.error("Error fetching user's cart data:", error);
                        });
                } else {
                    // If the user is not logged in, show an alert
                    alert("You need to sign in first to access the cart!");
                }
            });

            // Function to fetch user's cart data from the server
            function fetchUserCartData(userId) {
                // Replace this with your actual API endpoint for fetching user's cart data
                const apiUrl = `https://your-api-domain.com/api/user/${userId}/cart`;

                return fetch(apiUrl)
                    .then((response) => {
                        if (!response.ok) {
                            throw new Error(`HTTP error! Status: ${response.status}`);
                        }
                        return response.json();
                    });
            }


            onAuthStateChanged(auth, (user) => {
                if (user) {
                    signOutButton.style.display = "block";
                    message.style.display = "block";
                    mButton.style.display = "none";
                    mModal.style.display = "none";

                    const providerLogo = user.providerData[0].providerId.split('.')[0]; // Extract the provider name (google, facebook, twitter)
                    let logoIconClass;

                    switch (providerLogo) {
                        case "google":
                            logoIconClass = "fa fa-google"; // Font Awesome class for Google icon
                            break;
                        case "facebook":
                            logoIconClass = "fa fa-facebook"; // Font Awesome class for Facebook icon
                            break;
                        case "twitter":
                            logoIconClass = "fa fa-twitter"; // Font Awesome class for Twitter icon
                            break;
                        default:
                            logoIconClass = "fa fa-envelope"; // Default user icon (You can change this to any other default icon)
                            break;
                    }

                    userName.innerHTML = `<div class="user-info" style="display: flex; align-items: center; justify-content: space-between">
                <div class="user1-icon" style="margin-right: 10px; font-size: 30px;"><i class="fa fa-user"></i></div>
                <div class="user-icon" style="margin-right: 10px; font-size: 30px;"><i class="${logoIconClass}"></i></div>
                <div class="username" style="margin-left: auto;">${user.displayName}</div>
            </div>`;

                } else {
                    signOutButton.style.display = "none";
                    message.style.display = "none";
                    mButton.style.display = "block";
                }
            });

            signInButton.addEventListener('click', userSignIn);
            signInTw.addEventListener('click', userSignInTw);
            signInFb.addEventListener('click', userSignInFb);
            signOutButton.addEventListener('click', userSignOut);

        </script>
        <script src="bundle.js"></script>

</body>

</html>